SELECT FK.source_id, FK.etl_run_number, FK.table_name, FK.column_name, FK.table_row_key, FK.keyword, FK.occurrence, FK.soft_deleted_flag, FI.priority_src_key, FI.opened_on_key, FI.customer_key, FI.configuration_item_key, FI.opened_by_department_key, FI.assignment_group_key, FI.reported_type_src_key, FI.outage_start_on_key, FI.outage_end_on_key, FI.sub_category_src_key, FI.change_request_key, FI.severity_src_key, FI.urgency_src_key, FI.opened_by_key, FI.close_code_src_key, FI.grand_parent_incident_key, FI.domain_key, FI.outage_start_time_key, FI.company_key, FI.dormancy_age_key, FI.state_src_key, FI.problem_key, FI.parent_incident_key, FI.opened_time_key, FI.category_src_key, FI.due_on_key, FI.last_resolved_by_key, FI.impact_src_key, FI.closed_on_key, FI.closed_by_key, FI.service_level_src_key, FI.assigned_to_key, FI.resolved_by_group_key, FI.age_key, FI.outage_end_time_key, FI.caused_by_change_key, FI.location_key, FI.last_resolved_on_key, FI.incident_key FROM (<<tenant>>_mdwdb.f_keyword FK JOIN <<tenant>>_mdwdb.f_incident FI ON ((FK.table_row_key = FI.incident_key))) WHERE ((((FK.table_name) = 'd_incident') AND (FK.soft_deleted_flag = 'N')) AND (FI.soft_deleted_flag = 'N')) UNION ALL SELECT FK.source_id, FK.etl_run_number, FK.table_name, FK.column_name, FK.task_key AS table_row_key, FK.keyword, sum(FK.occurrence) AS occurrence, FK.soft_deleted_flag, FI.priority_src_key, FI.opened_on_key, FI.customer_key, FI.configuration_item_key, FI.opened_by_department_key, FI.assignment_group_key, FI.reported_type_src_key, FI.outage_start_on_key, FI.outage_end_on_key, FI.sub_category_src_key, FI.change_request_key, FI.severity_src_key, FI.urgency_src_key, FI.opened_by_key, FI.close_code_src_key, FI.grand_parent_incident_key, FI.domain_key, FI.outage_start_time_key, FI.company_key, FI.dormancy_age_key, FI.state_src_key, FI.problem_key, FI.parent_incident_key, FI.opened_time_key, FI.category_src_key, FI.due_on_key, FI.last_resolved_by_key, FI.impact_src_key, FI.closed_on_key, FI.closed_by_key, FI.service_level_src_key, FI.assigned_to_key, FI.resolved_by_group_key, FI.age_key, FI.outage_end_time_key, FI.caused_by_change_key, FI.location_key, FI.last_resolved_on_key, FI.incident_key FROM (<<tenant>>_mdwdb.f_keyword FK JOIN <<tenant>>_mdwdb.f_incident FI ON ((FK.task_key = FI.incident_key))) WHERE ((((FK.table_name) = 'incident_work_notes') AND (FK.soft_deleted_flag = 'N')) AND (FI.soft_deleted_flag = 'N')) GROUP BY FK.source_id, FK.etl_run_number, FK.table_name, FK.column_name, FK.task_key, FK.keyword, FK.soft_deleted_flag, FI.priority_src_key, FI.opened_on_key, FI.customer_key, FI.configuration_item_key, FI.opened_by_department_key, FI.assignment_group_key, FI.reported_type_src_key, FI.outage_start_on_key, FI.outage_end_on_key, FI.sub_category_src_key, FI.change_request_key, FI.severity_src_key, FI.urgency_src_key, FI.opened_by_key, FI.close_code_src_key, FI.grand_parent_incident_key, FI.domain_key, FI.outage_start_time_key, FI.company_key, FI.dormancy_age_key, FI.state_src_key, FI.problem_key, FI.parent_incident_key, FI.opened_time_key, FI.category_src_key, FI.due_on_key, FI.last_resolved_by_key, FI.impact_src_key, FI.closed_on_key, FI.closed_by_key, FI.service_level_src_key, FI.assigned_to_key, FI.resolved_by_group_key, FI.age_key, FI.outage_end_time_key, FI.caused_by_change_key, FI.location_key, FI.last_resolved_on_key, FI.incident_key;
