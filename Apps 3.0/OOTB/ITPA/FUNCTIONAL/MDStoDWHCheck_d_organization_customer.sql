select  CASE WHEN count(1) > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
 CASE WHEN count(1) >0 THEN 'MDS to DWH data validation failed for d_organization_customer' ELSE 'SUCCESS' END as Message
from app_test.ds_organization_customer SRC
join <<tenant>>_mdwdb.d_organization_customer TRGT
on(SRC.row_id=TRGT.row_id
and SRC.source_id=TRGT.source_id)
where concat(coalesce(SRC.row_id,''),coalesce(SRC.source_id,''),coalesce(SRC.parent_row_id,''),coalesce(SRC.customer_number,''),coalesce(SRC.organization_name,''),coalesce(SRC.st_address1,''),coalesce(SRC.st_address2,''),coalesce(SRC.st_address3,''),coalesce(SRC.st_address4,''),coalesce(SRC.city_code,''),coalesce(SRC.state_code,''),coalesce(SRC.postal_code,''),coalesce(SRC.country_code,''),coalesce(SRC.region_code,''),coalesce(SRC.email_address,''),coalesce(SRC.work_phone,''),coalesce(SRC.fax_number,''),coalesce(SRC.secondary_work_phone,''),coalesce(SRC.home_page_url,''),coalesce(SRC.organization_registration_number,''),coalesce(SRC.prospect_flag,''),coalesce(SRC.supplier_flag,''),coalesce(SRC.competitor_flag,''),coalesce(SRC.account_flag,''),coalesce(SRC.account_location,''),coalesce(SRC.customer_type_code,''),coalesce(SRC.customer_category_code,''),coalesce(SRC.customer_currency_code,''),coalesce(SRC.business_unit_name,''),coalesce(SRC.channel_flag,''),coalesce(SRC.domestic_universal_duns_number,''),coalesce(SRC.duns_number,''),coalesce(SRC.number_of_employees,''),coalesce(SRC.formed_date,''),coalesce(SRC.global_ultimate_duns_number,''),coalesce(SRC.line_of_business,''),coalesce(SRC.partner_flag,''),coalesce(SRC.parent_duns_number,''),coalesce(SRC.primary_competitor_id,''),coalesce(SRC.primary_industry_name,''),coalesce(SRC.customer_class_code,''),coalesce(SRC.credit_score,''),coalesce(SRC.customer_end_date,''),coalesce(SRC.customer_since_date,''),coalesce(SRC.key_competitor,''),coalesce(SRC.tax_identification_type,''),coalesce(SRC.tax_identification_number,''),coalesce(SRC.d_and_b_site_name,''),coalesce(SRC.d_and_b_global_name,''),coalesce(SRC.d_and_b_legal_name,''),coalesce(SRC.solicitation_flag,''),coalesce(SRC.do_not_call_flag,''),coalesce(SRC.do_not_email_flag,''),coalesce(SRC.do_not_fax_flag,''),coalesce(SRC.do_not_mail_flag,''),coalesce(SRC.preferred_language,''),coalesce(SRC.organization_active_flag,''),coalesce(SRC.created_by,''),coalesce(SRC.changed_by,''),coalesce(SRC.created_on,''),coalesce(SRC.changed_on,''),coalesce(SRC.enduser_flag,''),coalesce(SRC.reseller_flag,''),coalesce(SRC.distributor_flag,''),coalesce(SRC.customer_contact1_name,''),coalesce(SRC.customer_contact2_name,''),coalesce(SRC.customer_contact3_name,'') ) 
<>  concat(coalesce(TRGT.row_id,''),coalesce(TRGT.source_id,''),coalesce(TRGT.parent_row_id,''),coalesce(TRGT.customer_number,''),coalesce(TRGT.organization_name,''),coalesce(TRGT.st_address1,''),coalesce(TRGT.st_address2,''),coalesce(TRGT.st_address3,''),coalesce(TRGT.st_address4,''),coalesce(TRGT.city_code,''),coalesce(TRGT.state_code,''),coalesce(TRGT.postal_code,''),coalesce(TRGT.country_code,''),coalesce(TRGT.region_code,''),coalesce(TRGT.email_address,''),coalesce(TRGT.work_phone,''),coalesce(TRGT.fax_number,''),coalesce(TRGT.secondary_work_phone,''),coalesce(TRGT.home_page_url,''),coalesce(TRGT.organization_registration_number,''),coalesce(TRGT.prospect_flag,''),coalesce(TRGT.supplier_flag,''),coalesce(TRGT.competitor_flag,''),coalesce(TRGT.account_flag,''),coalesce(TRGT.account_location,''),coalesce(TRGT.customer_type_code,''),coalesce(TRGT.customer_category_code,''),coalesce(TRGT.customer_currency_code,''),coalesce(TRGT.business_unit_name,''),coalesce(TRGT.channel_flag,''),coalesce(TRGT.domestic_universal_duns_number,''),coalesce(TRGT.duns_number,''),coalesce(TRGT.number_of_employees,''),coalesce(TRGT.formed_date,''),coalesce(TRGT.global_ultimate_duns_number,''),coalesce(TRGT.line_of_business,''),coalesce(TRGT.partner_flag,''),coalesce(TRGT.parent_duns_number,''),coalesce(TRGT.primary_competitor_id,''),coalesce(TRGT.primary_industry_name,''),coalesce(TRGT.customer_class_code,''),coalesce(TRGT.credit_score,''),coalesce(TRGT.customer_end_date,''),coalesce(TRGT.customer_since_date,''),coalesce(TRGT.key_competitor,''),coalesce(TRGT.tax_identification_type,''),coalesce(TRGT.tax_identification_number,''),coalesce(TRGT.d_and_b_site_name,''),coalesce(TRGT.d_and_b_global_name,''),coalesce(TRGT.d_and_b_legal_name,''),coalesce(TRGT.solicitation_flag,''),coalesce(TRGT.do_not_call_flag,''),coalesce(TRGT.do_not_email_flag,''),coalesce(TRGT.do_not_fax_flag,''),coalesce(TRGT.do_not_mail_flag,''),coalesce(TRGT.preferred_language,''),coalesce(TRGT.organization_active_flag,''),coalesce(TRGT.created_by,''),coalesce(TRGT.changed_by,''),coalesce(TRGT.created_on,''),coalesce(TRGT.changed_on,''),coalesce(TRGT.enduser_flag,''),coalesce(TRGT.reseller_flag,''),coalesce(TRGT.distributor_flag,''),coalesce(TRGT.customer_contact1_name,''),coalesce(TRGT.customer_contact2_name,''),coalesce(TRGT.customer_contact3_name,'')) ;
