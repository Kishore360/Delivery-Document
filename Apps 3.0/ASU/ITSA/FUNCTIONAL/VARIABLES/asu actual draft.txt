Handle unspecified



answer_final table not present ???
 
extension of the table 
question_final is item_option_new_final
question_answer_final is sc_item_option_final which has value having row_id as answers and its value is present in 
dimension table d_internal_contact


sc_item_option_final-- why multiple answers??

ask anjali cat item and other item difference

cat item,variable_set ????

select variable_set,question_text,cat_item,name,sys_id from asu_mdsdb.item_option_new_final
where variable_set is not null and question_text  is not null and cat_item  is not null??

TO TEST:
========
.Data is available at per request_item per variable.??? NO (PLS CHECK THIS WITH ASU)

lsm_ls is buit here
sys_choice is coming from service now.
f_request_item will have same keys repeating multiple times per request item for different variables
and this is supressed in the views section by aliasing for different variables and creating different views.

There is no much dependency on mstr.if we change to other tool also the views will help us.*****

why sys_choice is used??

it has list of choices like select box, multi line text, check box where the variable question will display
and its datatype will be in the lsm_ls_variable_datatype table of workdb.

-1 validations

select d.text,d.value,d.question,a.question_text,b.value ,aaa.variable_type   from  
asu_mdsdb.question_final a inner join asu_mdsdb.question_answer_final b
on b.question=a.sys_id
join asu_mdsdb.incident_final c
on b.table_sys_id=c.sys_id and c.sys_id='e66f15776f8c310051a1da0cbb3ee4b0'
left join asu_mdsdb.question_choice_final d 
on b.question=d.question
join asu_workdb.lsm_ls_variable_list aaa on  b.question=aaa.row_id 

1 cat item -->multiple req items
1 req item--1 cat item 

duplicates in the tables



BUILDING:DONE
=========


select count(1) from 

(select sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='building') e

inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new

inner join asu_mdsdb.sc_item_option_mtom_final d

on d.sc_item_option=b.sys_id

inner join asu_mdwdb.d_request_item c

on d.request_item=c.row_id and c.source_id=d.sourceinstance

inner join asu_mdwdb.d_location f on b.value=f.row_id and b.sourceinstance=f.source_id
inner 
join asu_mdwdb.f_request_item_variable_c a 
on SUBSTRING(a.row_id,1,32)= b.sys_id
 AND SUBSTRING(a.row_id,34,32)=  d.request_item
AND a.source_id=b.sourceinstance

WHERE f.row_key <>a.building_c_key


CAMPUS:DONE
===========
select count(1) from 

(select sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='campus') e

inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new

inner join asu_mdsdb.sc_item_option_mtom_final d

on d.sc_item_option=b.sys_id

inner join asu_mdwdb.d_request_item c

on d.request_item=c.row_id and c.source_id=d.sourceinstance

inner join asu_mdwdb.d_location f on b.value=f.row_id and b.sourceinstance=f.source_id
inner 
join asu_mdwdb.f_request_item_variable_c a 
on SUBSTRING(a.row_id,1,32)= b.sys_id
 AND SUBSTRING(a.row_id,34,32)=  d.request_item
 AND a.source_id=b.sourceinstance

WHERE f.row_key <>a.building_c_key


V_DEPARTMENT:DONE
=============
select count(1) from 


(select sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='v_department') e


inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new


inner join asu_mdsdb.sc_item_option_mtom_final d

on d.sc_item_option=b.sys_id


inner join asu_mdwdb.d_request_item c

on d.request_item=c.row_id and c.source_id=d.sourceinstance


inner join asu_mdwdb.d_internal_organization f on concat('DEPARTMENT~',b.value)=f.row_id and b.sourceinstance=f.source_id
 

inner join asu_mdwdb.f_request_item_variable_c a 
on SUBSTRING(a.row_id,1,32)= b.sys_id
 
AND SUBSTRING(a.row_id,34,32)=  d.request_item
 AND a.source_id=b.sourceinstance


WHERE f.row_key <>a.v_department_c_key


V_CAMPUS:DONE
=========
select count(1) from 

(select sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='v_campus') e

inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new

inner join asu_mdsdb.sc_item_option_mtom_final d

on d.sc_item_option=b.sys_id

inner join asu_mdwdb.d_request_item c

on d.request_item=c.row_id and c.source_id=d.sourceinstance

inner join asu_mdwdb.d_location f on b.value=f.row_id and b.sourceinstance=f.source_id
inner 
join asu_mdwdb.f_request_item_variable_c a 
on SUBSTRING(a.row_id,1,32)= b.sys_id
 AND SUBSTRING(a.row_id,34,32)=  d.request_item
 AND a.source_id=b.sourceinstance

WHERE f.row_key <>a.v_campus_c_key


 u_request_type:DONE: multiple entries on value column reported
===================

CREATE TABLE asu_mdwdb.xxxxx(r1 varchar(100),r2 varchar(100),reference_c_key bigint, index(r1),index(r2),index(reference_c_key));
INSERT INTO asu_mdwdb.xxxxx 
SELECT substring(row_id,1,32) as r1, SUBSTRING(row_id,34,32) as r2, reference_c_key  FROM asu_mdwdb.f_request_item_variable_c;

select f.row_key ,a.reference_c_key,a.r1, b.sys_id , a.r2,d.request_item from 
-- b.sys_id,temp_substrin.part1 ,temp_substrin.part2,d.request_item,f.row_key,a.reference_c_key from 
-- f.row_key ,a.reference_c_key from 
-- (select b.value as asd,e.name,concat(b.sys_id,'~',d.request_item) as rowid,f.row_key,t.label,f.value,b.item_option_new,g.row_id,
-- f.variable_id from 
(select type,sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='u_request_type'
and  sys_id  in 
(select  row_id from  asu_workdb.lsm_ls_variable_list lvl where 
lvl.table_name='request_item' and lvl.variable_type!='Reference') 
 ) e
inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new
and b.sourceinstance=e.sourceinstance  -- and b.sys_id='0385358131098640c50b53f329f9bd4c'

inner join asu_mdsdb.sc_item_option_mtom_final d
on d.sc_item_option=b.sys_id
and b.sourceinstance=d.sourceinstance

inner join asu_mdwdb.d_request_item c
on d.request_item=c.row_id and c.source_id=d.sourceinstance

inner join asu_mdwdb.d_variable_c g on b.item_option_new=g.row_id and g.source_id=d.sourceinstance
-- inner join  temp_substrin   temp_substrin on b.sys_id=part1 and part2=  d.request_item

inner join asu_mdwdb.d_variable_lov_c f on f.variable_id=g.row_id and f.value=b.value
join asu_mdsdb.sys_choice_final t  on t.name like 'question' and e.type=t.value and
 t.label='Select Box' and t.element='type' and t.label!='Reference'
inner join asu_mdwdb.xxxxx a 
on  a.r1= b.sys_id and a.r2=d.request_item
 where f.row_key <>a.reference_c_key ;

 requested_for:DONE
===============
select count(1) from 

(select sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='requested_for') e

inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new

inner join asu_mdsdb.sc_item_option_mtom_final d

on d.sc_item_option=b.sys_id

inner join asu_mdwdb.d_request_item c

on d.request_item=c.row_id and c.source_id=d.sourceinstance

inner join asu_mdwdb.d_internal_contact f on concat('INTERNAL_CONTACT~',b.value)=f.row_id and b.sourceinstance=f.source_id
inner 
join asu_mdwdb.f_request_item_variable_c a 
on SUBSTRING(a.row_id,1,32)= b.sys_id
 AND SUBSTRING(a.row_id,34,32)=  d.request_item
 AND a.source_id=b.sourceinstance

WHERE f.row_key <>a.requested_for_c_key




 v_request_type:DONE
=================
drop table asu_mdwdb.xxxxx

CREATE TABLE asu_mdwdb.xxxxx(r1 varchar(100),r2 varchar(100),reference_c_key bigint, 
index(r1),index(r2),index(reference_c_key));
INSERT INTO asu_mdwdb.xxxxx 
SELECT substring(row_id,1,32) as r1, SUBSTRING(row_id,34,32) as r2, reference_c_key  FROM 
asu_mdwdb.f_request_item_variable_c;

select count(1) from 
-- f.row_key ,a.reference_c_key from 
-- (select b.value as asd,e.name,concat(b.sys_id,'~',d.request_item) as rowid,f.row_key,t.label,f.value,b.item_option_new,g.row_id,
-- 
(select type,sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='v_request_type'
and  

sys_id  in 
(select  row_id from  asu_workdb.lsm_ls_variable_list lvl where 
lvl.table_name='request_item' and lvl.variable_type!='Reference') 
 ) e
inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new
and b.sourceinstance=e.sourceinstance  -- and b.sys_id='0385358131098640c50b53f329f9bd4c'

inner join asu_mdsdb.sc_item_option_mtom_final d
on d.sc_item_option=b.sys_id
and 

b.sourceinstance=d.sourceinstance

inner join asu_mdwdb.d_request_item c on d.request_item=c.row_id and c.source_id=d.sourceinstance

inner join asu_mdwdb.d_variable_c g on b.item_option_new=g.row_id and g.source_id=d.sourceinstance

inner join asu_mdwdb.d_variable_lov_c f on f.variable_id=g.row_id and f.value=b.value

join asu_mdsdb.sys_choice_final t  on t.name like 'question' and e.type=t.value and t.label='Select Box' and 

t.element='type' and t.label!='Reference'
inner join asu_mdwdb.xxxxx a 
on  a.r1= b.sys_id and a.r2=d.request_item
 where f.row_key <>a.reference_c_key ;

 u_request_category:DONE
====================

select count(1) from 
-- f.row_key ,a.reference_c_key from 
-- (select b.value as asd,e.name,concat(b.sys_id,'~',d.request_item) as rowid,f.row_key,t.label,f.value,b.item_option_new,g.row_id,
-- 
(select type,sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='u_request_category'
and  

sys_id  in 
(select  row_id from  asu_workdb.lsm_ls_variable_list lvl where 
lvl.table_name='request_item' and lvl.variable_type!='Reference') 
 ) e
inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new
and b.sourceinstance=e.sourceinstance  -- and b.sys_id='0385358131098640c50b53f329f9bd4c'

inner join asu_mdsdb.sc_item_option_mtom_final d
on d.sc_item_option=b.sys_id
and 

b.sourceinstance=d.sourceinstance

inner join asu_mdwdb.d_request_item c on d.request_item=c.row_id and c.source_id=d.sourceinstance

inner join asu_mdwdb.d_variable_c g on b.item_option_new=g.row_id and g.source_id=d.sourceinstance

inner join asu_mdwdb.d_variable_lov_c f on f.variable_id=g.row_id and f.value=b.value

join asu_mdsdb.sys_choice_final t  on t.name like 'question' and e.type=t.value and t.label='Select Box' and 

t.element='type' and t.label!='Reference'
inner join asu_mdwdb.xxxxx a 
on  a.r1= b.sys_id and a.r2=d.request_item
 where f.row_key <>a.reference_c_key ;

request_type:DONE
=============
select count(1) from 
-- f.row_key ,a.reference_c_key from 
-- (select b.value as asd,e.name,concat(b.sys_id,'~',d.request_item) as rowid,f.row_key,t.label,f.value,b.item_option_new,g.row_id,
-- 
(select type,sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='request_type'
and  

sys_id  in 
(select  row_id from  asu_workdb.lsm_ls_variable_list lvl where 
lvl.table_name='request_item' and lvl.variable_type!='Reference') 
 ) e
inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new
and b.sourceinstance=e.sourceinstance  -- and b.sys_id='0385358131098640c50b53f329f9bd4c'

inner join asu_mdsdb.sc_item_option_mtom_final d
on d.sc_item_option=b.sys_id
and 

b.sourceinstance=d.sourceinstance

inner join asu_mdwdb.d_request_item c on d.request_item=c.row_id and c.source_id=d.sourceinstance

inner join asu_mdwdb.d_variable_c g on b.item_option_new=g.row_id and g.source_id=d.sourceinstance

inner join asu_mdwdb.d_variable_lov_c f on f.variable_id=g.row_id and f.value=b.value

join asu_mdsdb.sys_choice_final t  on t.name like 'question' and e.type=t.value and t.label='Select Box' and 

t.element='type' and t.label!='Reference'
inner join asu_mdwdb.xxxxx a 
on  a.r1= b.sys_id and a.r2=d.request_item
 where f.row_key =a.reference_c_key ;

u_support_group_school:DONE
========================


select count(1) from 
-- f.row_key ,a.reference_c_key from 
-- (select b.value as asd,e.name,concat(b.sys_id,'~',d.request_item) as rowid,f.row_key,t.label,f.value,b.item_option_new,g.row_id,
-- 
(select type,sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='u_support_group_school'
and  

sys_id  in 
(select  row_id from  asu_workdb.lsm_ls_variable_list lvl where 
lvl.table_name='request_item' and lvl.variable_type!='Reference') 
 ) e
inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new
and b.sourceinstance=e.sourceinstance  -- and b.sys_id='0385358131098640c50b53f329f9bd4c'

inner join asu_mdsdb.sc_item_option_mtom_final d
on d.sc_item_option=b.sys_id
and 

b.sourceinstance=d.sourceinstance

inner join asu_mdwdb.d_request_item c on d.request_item=c.row_id and c.source_id=d.sourceinstance

inner join asu_mdwdb.d_variable_c g on b.item_option_new=g.row_id and g.source_id=d.sourceinstance

inner join asu_mdwdb.d_variable_lov_c f on f.variable_id=g.row_id and f.value=b.value

join asu_mdsdb.sys_choice_final t  on t.name like 'question' and e.type=t.value and t.label='Select Box' and 

t.element='type' and t.label!='Reference'
inner join asu_mdwdb.xxxxx a 
on  a.r1= b.sys_id and a.r2=d.request_item
 where f.row_key <>a.reference_c_key ;


 v_request_category:DONE
=====================


select count(1) from 
-- f.row_key ,a.reference_c_key from 
-- (select b.value as asd,e.name,concat(b.sys_id,'~',d.request_item) as rowid,f.row_key,t.label,f.value,b.item_option_new,g.row_id,
-- 
(select type,sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='v_request_category'
and  

sys_id  in 
(select  row_id from  asu_workdb.lsm_ls_variable_list lvl where 
lvl.table_name='request_item' and lvl.variable_type!='Reference') 
 ) e
inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new
and b.sourceinstance=e.sourceinstance  -- and b.sys_id='0385358131098640c50b53f329f9bd4c'

inner join asu_mdsdb.sc_item_option_mtom_final d
on d.sc_item_option=b.sys_id
and 

b.sourceinstance=d.sourceinstance

inner join asu_mdwdb.d_request_item c on d.request_item=c.row_id and c.source_id=d.sourceinstance

inner join asu_mdwdb.d_variable_c g on b.item_option_new=g.row_id and g.source_id=d.sourceinstance

inner join asu_mdwdb.d_variable_lov_c f on f.variable_id=g.row_id and f.value=b.value

join asu_mdsdb.sys_choice_final t  on t.name like 'question' and e.type=t.value and t.label='Select Box' and 

t.element='type' and t.label!='Reference'
inner join asu_mdwdb.xxxxx a 
on  a.r1= b.sys_id and a.r2=d.request_item
 where f.row_key =a.reference_c_key ;

 u_room:DONE
=======


select count(1) from (
select 
-- from (select count(1)
a.longtext_value aa ,
 Case when lvd.data_type ='LONGTEXT' THEN left(b.value,255)   else null end as bb 
 from 
(select type,sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='u_room'
and  

sys_id  in 
(select  row_id from  asu_workdb.lsm_ls_variable_list lvl where 
lvl.table_name='request_item' and lvl.variable_type!='Reference') 
 ) e
inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new
and b.sourceinstance=e.sourceinstance  -- and b.sys_id='0385358131098640c50b53f329f9bd4c'

inner join asu_mdsdb.sc_item_option_mtom_final d
on d.sc_item_option=b.sys_id and b.sourceinstance=d.sourceinstance

inner join asu_mdwdb.d_request_item c
on d.request_item=c.row_id and c.source_id=d.sourceinstance
join asu_workdb.lsm_ls_variable_list z on e.sys_id=z.row_id and z.table_name='request_item' and z.variable_type!='Reference'
join asu_mdsdb.sys_choice_final t  on t.name='question' and e.type=t.value
join asu_workdb.lsm_ls_variable_datatype lvd on t.label = lvd.variable_type 
join asu_mdwdb.xxxxx a 
on  a.r1= b.sys_id and a.r2=d.request_item)v
where aa<>bb


room:DATA TRUNCATION ISSUE
====
select * from (
select 
-- from (select count(1)
a.longtext_value aa , a.r1, b.sys_id  ,a.r2,d.request_item,
Case when lvd.data_type ='LONGTEXT' THEN left(b.value,255)   else null end as bb 
 from 
(select type,sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='room'
and  

sys_id  in 
(select  row_id from  asu_workdb.lsm_ls_variable_list lvl where 
lvl.table_name='request_item' and lvl.variable_type!='Reference') 
 ) e
inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new
and b.sourceinstance=e.sourceinstance  -- and b.sys_id='0385358131098640c50b53f329f9bd4c'

inner join asu_mdsdb.sc_item_option_mtom_final d
on d.sc_item_option=b.sys_id and b.sourceinstance=d.sourceinstance

inner join asu_mdwdb.d_request_item c
on d.request_item=c.row_id and c.source_id=d.sourceinstance
join asu_workdb.lsm_ls_variable_list z on e.sys_id=z.row_id and z.table_name='request_item' and z.variable_type!='Reference'
join asu_mdsdb.sys_choice_final t  on t.name='question' and e.type=t.value
join asu_workdb.lsm_ls_variable_datatype lvd on t.label = lvd.variable_type 
join asu_mdwdb.xxxxx a 
on  a.r1= b.sys_id and a.r2=d.request_item)v
where aa<>bb

NO DATA TRUNCATION ISSUE QUERY:
==============================
select -- count(1) from 
-- select 
-- from (select count(1)
 length(a.lv) aa, -- , a.r1, b.sys_id  ,a.r2,d.request_item,
 length(Case when lvd.data_type ='LONGTEXT' THEN left(b.value,255)   else null end )as bb 
 from 
(select type,sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  
where name in ('room','u_room','v_room','u_room_number')
and  

sys_id  in 
(select  row_id from  asu_workdb.lsm_ls_variable_list lvl where 
lvl.table_name='request_item' and lvl.variable_type!='Reference') 
 ) e
inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new
and b.sourceinstance=e.sourceinstance  -- and b.sys_id='0385358131098640c50b53f329f9bd4c'

inner join asu_mdsdb.sc_item_option_mtom_final d
on d.sc_item_option=b.sys_id and b.sourceinstance=d.sourceinstance

inner join asu_mdwdb.d_request_item c
on d.request_item=c.row_id and c.source_id=d.sourceinstance
join asu_workdb.lsm_ls_variable_list z on e.sys_id=z.row_id and z.table_name='request_item' and z.variable_type!='Reference'
join asu_mdsdb.sys_choice_final t  on t.name='question' and e.type=t.value
join asu_workdb.lsm_ls_variable_datatype lvd on t.label = lvd.variable_type 
join asu_mdwdb.xxxxxyz a 
on  a.r1= b.sys_id and a.r2=d.request_item
and lv like '%South 141-142 241-242, Cerus 101-102, Cottonwood%'
 LENGTH OF 118  MATCHED 


v_room:DATA TRUNCATION ISSUE
======
select count(1) from 
(select a.longtext_value aa ,
Case when lvd.data_type ='LONGTEXT' THEN left(b.value,255)   else null end as bb 
from asu_mdwdb.f_request_item_variable_c a
inner join asu_mdsdb.sc_item_option_final b
on a.row_id=b.sys_id
and a.source_id=b.sourceinstance
inner join asu_mdsdb.sc_item_option_mtom_final d
on d.sc_item_option=b.sys_id
inner join asu_mdwdb.d_request_item c
on d.request_item=c.row_id and c.source_id=d.sourceinstance
inner join (select type,sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final a where name='v_room') e
on e.sys_id=b.item_option_new
join asu_workdb.lsm_ls_variable_list b on e.sys_id=b.row_id
join asu_mdsdb.sys_choice_final t  on t.name='question' and e.type=t.value
join asu_workdb.lsm_ls_variable_datatype lvd 
on t.label = lvd.variable_type 

)asd
where aa<>bb ;

 u_room_number:DATA TRUNCATION ISSUE:NOW OK
==============
select count(1) from 
(select a.longtext_value aa ,
Case when lvd.data_type ='LONGTEXT' THEN left(b.value,255)   else null end as bb 
from asu_mdwdb.f_request_item_variable_c a
inner join asu_mdsdb.sc_item_option_final b
on a.row_id=b.sys_id
and a.source_id=b.sourceinstance
inner join asu_mdsdb.sc_item_option_mtom_final d
on d.sc_item_option=b.sys_id
inner join asu_mdwdb.d_request_item c
on d.request_item=c.row_id and c.source_id=d.sourceinstance
inner join (select type,sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final a where name='u_room_number') e
on e.sys_id=b.item_option_new
join asu_workdb.lsm_ls_variable_list b on e.sys_id=b.row_id
join asu_mdsdb.sys_choice_final t  on t.name='question' and e.type=t.value
join asu_workdb.lsm_ls_variable_datatype lvd 
on t.label = lvd.variable_type 

)asd
where aa<>bb ;

 urgent:DONE
=======

select * from (
select 
-- from (select count(1)
a.r1, b.sys_id  ,a.r2,d.request_item,
 case when a.flag='Y' then 'Yes' else 'No' end aa ,Case when lvd.data_type ='FLAG' THEN left(b.value,255)   else null end as bb
 from 
(select type,sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='urgent'
and  

sys_id  in 
(select  row_id from  asu_workdb.lsm_ls_variable_list lvl where 
lvl.table_name='request_item' and lvl.variable_type!='Reference') 
 ) e
inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new
and b.sourceinstance=e.sourceinstance  -- and b.sys_id='0385358131098640c50b53f329f9bd4c'

inner join asu_mdsdb.sc_item_option_mtom_final d
on d.sc_item_option=b.sys_id and b.sourceinstance=d.sourceinstance

inner join asu_mdwdb.d_request_item c
on d.request_item=c.row_id and c.source_id=d.sourceinstance
join asu_workdb.lsm_ls_variable_list z on e.sys_id=z.row_id and z.table_name='request_item' and z.variable_type!='Reference'
join asu_mdsdb.sys_choice_final t  on t.name='question' and e.type=t.value
join asu_workdb.lsm_ls_variable_datatype lvd on t.label = lvd.variable_type 
join asu_mdwdb.xxxxx a 
on  a.r1= b.sys_id and a.r2=d.request_item)v
where aa<>bb

u_building:DONE
============
select count(1) from 
(select sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='u_building') e
inner join 

asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new
inner join asu_mdsdb.sc_item_option_mtom_final d
on 

d.sc_item_option=b.sys_id
inner join asu_mdwdb.d_request_item c on d.request_item=c.row_id and c.source_id=d.sourceinstance
inner join 

asu_mdwdb.d_location f on b.value=f.row_id and b.sourceinstance=f.source_id
inner 
join asu_mdwdb.f_request_item_variable_c a 
on 
SUBSTRING(a.row_id,1,32)= b.sys_id
 AND SUBSTRING(a.row_id,34,32)=  d.request_item
AND a.source_id=b.sourceinstance
WHERE f.row_key <>a.building_c_key

v_building:DONE
===========
select count(1) from 
(select sourceinstance,sys_id,name  from asu_mdsdb.item_option_new_final  where name='v_building') e
inner join asu_mdsdb.sc_item_option_final b 
on e.sys_id=b.item_option_new
inner join asu_mdsdb.sc_item_option_mtom_final d
on d.sc_item_option=b.sys_id
inner join asu_mdwdb.d_request_item c on d.request_item=c.row_id and c.source_id=d.sourceinstance
inner join asu_mdwdb.d_location f on b.value=f.row_id and b.sourceinstance=f.source_id
inner 
join asu_mdwdb.f_request_item_variable_c a 
on SUBSTRING(a.row_id,1,32)= b.sys_id
 AND SUBSTRING(a.row_id,34,32)=  d.request_item
AND a.source_id=b.sourceinstance
WHERE f.row_key <>a.v_building_c_key

Duplicates in LOV :
-------------------
select row_id,text,value,count(1) from asu_mdwdb.d_variable_lov_c 
group by 1,2,3
having count(1)>1


-1 in all the fact keys :
--------------------------
select * from asu_mdwdb.f_request_item_variable_c where building_c_key<0 
select * from asu_mdwdb.f_request_item_variable_c where  v_department_c_key<0
select * from asu_mdwdb.f_request_item_variable_c where  v_campus_c_key<0 
select * from asu_mdwdb.f_request_item_variable_c where  reference_c_key<0 
select * from asu_mdwdb.f_request_item_variable_c where  requested_for_c_key<0 
select * from asu_mdwdb.f_request_item_variable_c where  v_building_c_key<0 
 
VERIFIED ALL THE QUERIES AND FOUND THAT