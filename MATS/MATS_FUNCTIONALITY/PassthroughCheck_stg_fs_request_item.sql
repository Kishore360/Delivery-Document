
SELECT CASE WHEN COUNT(1) > 0 THEN 'FAILURE' ELSE 'SUCCESS' END AS Result, CASE WHEN COUNT(1) > 0 THEN 'Pass through columns from SC_REQ_ITEM_final to FS_REQUEST_ITEM did not match' ELSE 'SUCCESS' END AS Message FROM <<tenant>>_mdsdb.sc_req_item_final  S 
JOIN <<tenant>>_mdwdb.lsm_ls_source_timezone L

ON(S.sourceinstance= L.sourceid)
WHERE CRC32(CONCAT( IFNULL(sys_id,'UNSPECIFIED'), IFNULL(sourceinstance,'UNSPECIFIED'), IFNULL(number,'UNSPECIFIED'), IFNULL(request,'UNSPECIFIED'), IFNULL(cat_item,'UNSPECIFIED'), IFNULL(convert_tz(opened_at,source_time_zone,target_time_zone),''), 'INTERNAL_CONTACT~',IFNULL(opened_by,'UNSPECIFIED'), IFNULL(location,'UNSPECIFIED'), IFNULL(configuration_item,'UNSPECIFIED'), IFNULL(convert_tz(closed_at,source_time_zone,target_time_zone),''),'INTERNAL_CONTACT~', IFNULL(closed_by,'UNSPECIFIED'), IFNULL(convert_tz(due_date,source_time_zone,target_time_zone),'UNSPECIFIED'), IFNULL(state,'UNSPECIFIED'), IFNULL(approval,'UNSPECIFIED'), IFNULL(stage,'UNSPECIFIED'), IFNULL(impact,'UNSPECIFIED'), IFNULL(urgency,'UNSPECIFIED'), IFNULL(priority,'UNSPECIFIED'), IFNULL(time_worked,'UNSPECIFIED'), IFNULL(price,'UNSPECIFIED'), IFNULL(quantity,'UNSPECIFIED'), IFNULL(sys_domain,'UNSPECIFIED'), IFNULL(company,'UNSPECIFIED'), IFNULL(assignment_group,''),'INTERNAL_CONTACT~', IFNULL(assigned_to,'UNSPECIFIED'), IFNULL(reassignment_count,'UNSPECIFIED'), IFNULL(sys_created_by,'UNSPECIFIED'), IFNULL(sys_updated_by,'UNSPECIFIED'), IFNULL(sys_created_on,'UNSPECIFIED'), IFNULL(sys_updated_on,'UNSPECIFIED'), IFNULL(description,'UNSPECIFIED'), IFNULL(short_description,''))) NOT IN (SELECT CRC32(CONCAT( IFNULL(row_id,'UNSPECIFIED'), IFNULL(source_id,'UNSPECIFIED'), IFNULL(request_item_number,'UNSPECIFIED'), IFNULL(request_id,'UNSPECIFIED'), IFNULL(catalog_item_id,'UNSPECIFIED'), IFNULL(opened_on,'UNSPECIFIED'), IFNULL(opened_by_id,'UNSPECIFIED'), IFNULL(location_id,'UNSPECIFIED'), IFNULL(configuration_item_id,'UNSPECIFIED'), IFNULL(closed_on,'UNSPECIFIED'), IFNULL(closed_by_id,'UNSPECIFIED'), IFNULL(due_on,'UNSPECIFIED'), IFNULL(state_src_code,'UNSPECIFIED'), IFNULL(approval_state_src_code,'UNSPECIFIED'), IFNULL(stage_src_code,'UNSPECIFIED'), IFNULL(impact_src_code,'UNSPECIFIED'), IFNULL(urgency_src_code,'UNSPECIFIED'), IFNULL(priority_src_code,'UNSPECIFIED'), IFNULL(time_worked,'UNSPECIFIED'), IFNULL(price,'UNSPECIFIED'), IFNULL(quantity,'UNSPECIFIED'), IFNULL(domain_id,'UNSPECIFIED'), IFNULL(company_id,'UNSPECIFIED'), IFNULL(assignment_group_id,'UNSPECIFIED'), IFNULL(assigned_to_id,'UNSPECIFIED'), IFNULL(reassignment_count,'UNSPECIFIED'), IFNULL(created_by,'UNSPECIFIED'), IFNULL(changed_by,'UNSPECIFIED'), IFNULL(created_on,'UNSPECIFIED'), IFNULL(changed_on,'UNSPECIFIED'), IFNULL(description,'UNSPECIFIED'), IFNULL(short_description,''))) FROM <<tenant>>_workdb.stg_fs_request_item)
