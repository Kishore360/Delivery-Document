
SELECT CASE WHEN COUNT(1) > 0 THEN 'FAILURE' ELSE 'SUCCESS' END AS Result, CASE WHEN COUNT(1) > 0 THEN 'Pass through columns from TASK_SURVEY_final to FS_TASK_SURVEY did not match' ELSE 'SUCCESS' END AS Message FROM <<tenant>>_mdsdb.task_survey_final S 
JOIN <<tenant>>_mdwdb.lsm_ls_source_timezone L

ON(S.sourceinstance= L.sourceid) WHERE CRC32(CONCAT( IFNULL(sys_id,''), IFNULL(sourceinstance,''), IFNULL(survey,''), IFNULL(sent_to,''), IFNULL(convert_tz(requested_date,source_time_zone,target_time_zone),''), IFNULL(state,''), IFNULL(taken_by,''), IFNULL(convert_tz(completed_date,source_time_zone,target_time_zone),''), IFNULL(instance,''), IFNULL(task,''), IFNULL(sys_mod_count,''), IFNULL(sys_created_by,''), IFNULL(sys_updated_by,''), IFNULL(sys_created_on,''), IFNULL(sys_updated_on,''))) NOT IN (SELECT CRC32(CONCAT( IFNULL(row_id,''), IFNULL(source_id,''), IFNULL(survey_id,''), IFNULL(sent_to_id,''), IFNULL(requested_on,''), IFNULL(state,''), IFNULL(taken_by_id,''), IFNULL(completed_on,''), IFNULL(survey_instance_id,''), IFNULL(task_id,''), IFNULL(updated_count,''), IFNULL(created_by,''), IFNULL(changed_by,''), IFNULL(created_on,''), IFNULL(changed_on,''))) FROM <<tenant>>_workdb.stg_fs_task_survey)
