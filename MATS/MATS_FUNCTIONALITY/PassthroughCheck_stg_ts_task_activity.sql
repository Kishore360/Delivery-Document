
SELECT CASE WHEN COUNT(1) > 0 THEN 'FAILURE' ELSE 'SUCCESS' END AS Result, CASE WHEN COUNT(1) > 0 THEN 'Pass through columns from SYS_AUDIT_final to TS_TASK_ACTIVITY did not match' ELSE 'SUCCESS' END AS Message FROM <<tenant>>_mdsdb.sys_audit_final WHERE CRC32(CONCAT( IFNULL(sys_id,''), IFNULL(sourceinstance,''), IFNULL(documentkey,''), IFNULL(tablename,''), IFNULL(fieldname,''), IFNULL(oldvalue,''), IFNULL(newvalue,''), IFNULL(reason,''), IFNULL(record_checkpoint,''), IFNULL(user,''), IFNULL(sys_created_by,''), IFNULL(sys_created_on,''))) NOT IN (SELECT CRC32(CONCAT( IFNULL(row_id,''), IFNULL(source_id,''), IFNULL(task_id,''), IFNULL(task_wh_type,''), IFNULL(task_attribute_wh_name,''), IFNULL(task_attribute_wh_old_value,''), IFNULL(task_attribute_wh_new_value,''), IFNULL(update_reason,''), IFNULL(update_count,''), IFNULL(updated_by,''), IFNULL(created_by,''), IFNULL(created_on,''))) FROM <<tenant>>_workdb.stg_ts_task_activity)
