Report: New Report (8)
Job: 149840
Report Cache Used: No

Number of Columns Returned:                 134
Number of Temp Tables:                              1

Total Number of Passes:                               4
Number of SQL Passes:                 4
Number of Analytical Passes:                     0

Tables Accessed:
d_calendar_date
d_calendar_month
d_calendar_quarter
d_calendar_time
d_calendar_week
d_calendar_year
d_configuration_item
d_incident
d_incident_category
d_incident_close_code
d_incident_infrastructure_category_c
d_incident_severity
d_incident_state
d_incident_sub_type_c
d_incident_symptom_c
d_incident_variable_asset_tag
d_incident_variable_date_time
d_incident_variable_scope_of_work
d_incident_variable_work_window
d_internal_contact
d_internal_contact_mdm
d_internal_organization_department
d_internal_organization_group
d_internal_organization_legalentity
d_location
d_party
d_problem
d_task_contacttype
d_task_impact
d_task_priority
d_task_urgency
d_varaible_lov_data_center
dh_user_group_classification_hierarchy
dh_user_group_classification_hierarchy_level1
f_incident


SQL Statements:

CREATE TEMPORARY TABLE ZZMD00(
                urgency_src_key             BIGINT, 
                row_key              BIGINT, 
                priority_src_key               BIGINT, 
                row_key0            BIGINT, 
                impact_src_key                BIGINT, 
                row_key1            BIGINT, 
                problem_key     BIGINT, 
                row_key3            BIGINT, 
                row_key4            BIGINT, 
                state_src_key   BIGINT, 
                severity_src_key             BIGINT, 
                close_code_src_key       BIGINT, 
                row_key5            BIGINT, 
                incident_key      BIGINT, 
                hour_24_format_num  INTEGER, 
                row_current_key            BIGINT, 
                opened_by_department_key   BIGINT, 
                calendar_date_key         BIGINT, 
                row_key7            BIGINT, 
                configuration_item_key               BIGINT, 
                organization_name0      VARCHAR(255), 
                row_key8            BIGINT, 
                assignment_group_key                BIGINT, 
                row_key9            BIGINT, 
                opened_severity_high_incident               INTEGER, 
                WJXBFS1              INTEGER)

insert into ZZMD00 
select    a11.urgency_src_key AS urgency_src_key,
                a11.reported_type_src_key AS row_key,
                a11.priority_src_key AS priority_src_key,
                a11.location_key AS row_key0,
                a11.impact_src_key AS impact_src_key,
                a11.symptom_src_key_c AS row_key1,
                a11.problem_key AS problem_key,
                a11.primary_contact AS row_key3,
                a11.infrastructure_category_src_key_c AS row_key4,
                a11.state_src_key AS state_src_key,
                a11.severity_src_key AS severity_src_key,
                a11.close_code_src_key AS close_code_src_key,
                a11.category_src_key AS row_key5,
                a11.incident_key AS incident_key,
                a15.hour_24_format_num AS hour_24_format_num,
                a14.row_current_key AS row_current_key,
                a13.row_key AS opened_by_department_key,
                a11.opened_on_key AS calendar_date_key,
                a11.data_center AS row_key7,
                a11.configuration_item_key AS configuration_item_key,
                a12.organization_name AS organization_name0,
                a11.business_service_key_c AS row_key8,
                a11.assignment_group_key AS assignment_group_key,
                a11.assigned_to_key AS row_key9,
                CASE WHEN max(CASE WHEN a16.lagging_count_of_days between 30 and 59 THEN 1 ELSE 0 END) = 1 THEN count(CASE WHEN a16.lagging_count_of_days between 30 and 59 THEN a11.row_key ELSE NULL END) ELSE NULL END AS opened_severity_high_incident,
                CASE WHEN max(CASE WHEN a16.lagging_count_of_days between 0 and 29 THEN 1 ELSE 0 END) = 1 THEN count(CASE WHEN a16.lagging_count_of_days between 0 and 29 THEN a11.row_key ELSE NULL END) ELSE NULL END AS WJXBFS1
from      ldb.f_incident    a11
                join        ldb.d_internal_organization_legalentity                a12
                  on         (a11.company_key = a12.row_key)
                join        ldb.d_internal_organization_department            a13
                  on         (a11.opened_by_department_key = a13.row_key)
                join        ldb.d_internal_contact  a14
                  on         (a11.opened_by_key = a14.row_key)
                join        ldb.d_calendar_time      a15
                  on         (a11.opened_time_key = a15.row_key)
                join        ldb.d_calendar_date      a16
                  on         (a11.opened_on_key = a16.row_key)
where   (a16.lagging_count_of_days between 30 and 59
or a16.lagging_count_of_days between 0 and 29)
group by              a11.urgency_src_key,
                a11.reported_type_src_key,
                a11.priority_src_key,
                a11.location_key,
                a11.impact_src_key,
                a11.symptom_src_key_c,
                a11.problem_key,
                a11.primary_contact,
                a11.infrastructure_category_src_key_c,
                a11.state_src_key,
                a11.severity_src_key,
                a11.close_code_src_key,
                a11.category_src_key,
                a11.incident_key,
                a15.hour_24_format_num,
                a14.row_current_key,
                a13.row_key,
                a11.opened_on_key,
                a11.data_center,
                a11.configuration_item_key,
                a12.organization_name,
                a11.business_service_key_c,
                a11.assignment_group_key,
                a11.assigned_to_key

select    distinct a13.asset_tag_number AS asset_tag_number,
                pa12.row_key9 AS row_key,
                a113.full_name AS full_name,
                '<img src='+chr(34)+'../images/Numerify/EMP_IMAGES/'+(a113.first_name)+(a113.last_name)+'.jpg'+chr(34)+'/>' AS CustCol_134,
                pa12.assignment_group_key AS assignment_group_key,
                a114.organization_name AS organization_name,
                a14.user_group_classification_level1 AS user_group_level1_key,
                a15.user_group_level2_key AS user_group_level2_key0,
                a16.u_bufg12_c AS u_bufg12_c,
                a16.u_bufg13_c AS u_bufg13_c,
                a16.bufg14_c AS bufg14_c,
                pa12.row_key8 AS row_key0,
                a115.name AS name,
                pa12.organization_name0 AS organization_name0,
                pa12.configuration_item_key AS configuration_item_key,
                a16.name AS name0,
                a16.category AS category,
                a16.class AS class,
                pa12.row_key7 AS row_key1,
                a116.text AS text,
                pa12.calendar_date_key AS calendar_date_key,
                a18.calendar_date AS calendar_date,
                a18.lagging_count_of_days AS lagging_count_of_days,
                TO_CHAR(a18.calendar_date,'MM/DD') AS CustCol,
                CURRENT_DATE AS CustCol_147,
                to_char(dateadd(day,-6,CURRENT_DATE-1),'DD') || '  -  ' || to_Char(CURRENT_DATE-1,'DD Month YYYY') AS CustCol_1340,
                to_char(dateadd(day,-29,CURRENT_DATE-1),'DD-Month') || '  -  ' || to_Char(CURRENT_DATE-1,'DD Month') AS CustCol_149,
                a17.date_time AS date_time,
                a18.day_name AS day_name0,
                a18.day_of_month AS day_of_month,
                a18.day_of_week AS day_of_week,
                a18.day_name AS week_day_flag,
                a18.day_of_year AS day_of_year,
                pa12.opened_by_department_key AS opened_by_department_key,
                a117.organization_name AS organization_name1,
                a19.detect_on_c AS detect_on_c,
                TO_CHAR(a19.detect_on_c, 'MM/DD/YYYY hh24:mi:ss') AS CustCol_185,
                pa12.row_current_key AS row_current_key,
                a118.full_name AS full_name0,
                a118.vip_flag AS vip_flag,
                a118.identification_number AS identification_number,
                a19.engagement_on_c AS engagement_on_c,
                TO_CHAR(a19.engagement_on_c, 'MM/DD/YYYY hh24:mi:ss') AS CustCol_184,
                pa12.hour_24_format_num AS hour_24_format_num,
                a119.hour_24_format_char AS hour_24_format_char,
                a119.hour_12_format_num AS hour_12_format_num,
                a119.hour_12_format_char AS hour_12_format_char,
                pa12.incident_key AS incident_key,
                a19.incident_number AS incident_number,
                a19.opened_on AS opened_on,
                case when current_date<a19.due_on then datediff(day,current_date,a19.due_on) end AS CustCol_135,
                case when current_date>a19.due_on then datediff(day,a19.due_on,current_date) end AS CustCol_136,
                datediff(day,a19.opened_on,current_date) AS row_key2,
                a19.source_url AS CustCol_164,
                a19.backlog_flag AS backlog_flag,
                pa12.row_key5 AS row_key3,
                a120.source_dimension_name AS source_dimension_name,
                a19.cause_code AS cause_code,
                a19.caused_by_change_flag AS caused_by_change_flag,
                a19.problem_flag AS problem_flag,
                a19.is_caused_by_task_flag AS is_caused_by_task_flag,
                a19.knowledge_flag AS knowledge_flag,
                pa12.close_code_src_key AS close_code_src_key,
                a121.source_dimension_code AS close_code_src_code,
                a19.major_incident_flag AS major_incident_flag,
                a19.met_sla_flag AS met_sla_flag,
                a19.multiple_assignment_flag AS multiple_assignment_flag,
                a19.priority_escalated_flag AS priority_escalated_flag,
                a19.reopened_flag AS reopened_flag,
                pa12.severity_src_key AS severity_src_key,
                a122.source_dimension_code AS source_dimension_code0,
                a122.source_dimension_name AS source_dimension_name0,
                a19.row_key AS row_key4,
                a19.short_description AS short_description,
                pa12.state_src_key AS state_src_key,
                a123.source_dimension_code AS source_dimension_code1,
                a123.source_dimension_name AS source_dimension_name1,
                pa12.row_key4 AS row_key5,
                a124.source_dimension_name AS source_dimension_name2,
                a18.month_start_date_key AS month_start_date_key,
                a18.month_name AS month_name,
                a133.lagging_count_of_month AS lagging_count_of_month,
                a16.offering_core_c AS offering_core_c,
                a16.offering_name_c AS offering_name_c,
                a16.offering_type_c AS offering_type_c,
                pa12.row_key3 AS row_key6,
                a125.name AS name1,
                pa12.problem_key AS problem_key,
                a126.problem_number AS problem_number,
                case when current_date<a126.due_on then datediff(day,current_date,a126.due_on) end AS CustCol_137,
                case when current_date>a126.due_on then datediff(day,a126.due_on,current_date) end AS CustCol_138,
                datediff(day,a126.opened_on,current_date) AS row_key7,
                a126.source_url AS CustCol_165,
                a18.quarter_start_date_key AS row_key8,
                a18.quarter_name AS quarter_name,
                a18.quarter_number_of_year AS quarter_number_of_year,
                a136.lagging_count_of_quarter AS lagging_count_of_quarter,
                a19.repair_date_on_c AS repair_date_on_c,
                TO_CHAR(a19.repair_date_on_c, 'MM/DD/YYYY hh24:mi:ss') AS CustCol_186,
                a19.resolver_group_c AS resolver_group_c,
                a110.scope_of_work AS scope_of_work,
                a19.solution_on_c AS solution_on_c,
                TO_CHAR(a19.solution_on_c, 'MM/DD/YYYY hh24:mi:ss') AS CustCol_183,
                a19.started_on_c AS started_on_c,
                TO_CHAR(a19.started_on_c, 'MM/DD/YYYY hh24:mi:ss') AS CustCol_182,
                a111.sub_type_key_c AS row_key9,
                a134.dimension_name AS dimension_name,
                pa12.row_key1 AS row_key10,
                a127.source_dimension_code AS source_dimension_code2,
                a127.source_dimension_name AS source_dimension_name3,
                pa12.impact_src_key AS impact_src_key,
                a128.source_dimension_code AS source_dimension_code3,
                a128.source_dimension_name AS source_dimension_name4,
                pa12.row_key0 AS row_key11,
                a129.location_name AS location_name,
                pa12.priority_src_key AS priority_src_key,
                a130.source_dimension_code AS source_dimension_code4,
                a130.source_dimension_name AS source_dimension_name5,
                pa12.row_key AS row_key12,
                a131.source_dimension_name AS source_dimension_name6,
                pa12.urgency_src_key AS urgency_src_key,
                a132.source_dimension_code AS source_dimension_code6,
                a132.source_dimension_name AS source_dimension_name7,
                a18.week_start_date_key AS row_key13,
                a18.week_name AS week_name,
                a18.week_number_of_year AS week_number_of_year,
                a135.lagging_count_of_weeks AS lagging_count_of_weeks,
                a18.week_day_flag AS week_day_flag0,
                a112.work_window_required AS work_window_required,
                a18.year_start_date_key AS row_key14,
                a18.year_name AS year_name,
                a137.lagging_count_of_year AS lagging_count_of_year,
                pa12.opened_severity_high_incident AS opened_severity_high_incident,
                pa12.WJXBFS1 AS WJXBFS1
from      ZZMD00               pa12
                join        ldb.d_incident_variable_asset_tag          a13
                  on         (pa12.incident_key = a13.row_key)
                join        ldb.dh_user_group_classification_hierarchy       a14
                  on         (pa12.assignment_group_key = a14.user_group_key)
                join        ldb.dh_user_group_classification_hierarchy_level1        a15
                  on         (a14.user_group_classification_level1 = a15.user_group_level1_key)
                join        ldb.d_configuration_item            a16
                  on         (pa12.configuration_item_key = a16.row_key)
                join        ldb.d_incident_variable_date_time        a17
                  on         (pa12.incident_key = a17.row_key)
                join        ldb.d_calendar_date      a18
                  on         (pa12.calendar_date_key = a18.row_key)
                join        ldb.d_incident   a19
                  on         (pa12.incident_key = a19.row_key)
                join        ldb.d_incident_variable_scope_of_work             a110
                  on         (pa12.incident_key = a110.row_key)
                join        ldb.f_incident    a111
                  on         (a18.row_key = a111.opened_on_key and 
                pa12.assignment_group_key = a111.assignment_group_key and 
                pa12.calendar_date_key = a111.opened_on_key and 
                pa12.close_code_src_key = a111.close_code_src_key and 
                pa12.configuration_item_key = a111.configuration_item_key and 
                pa12.impact_src_key = a111.impact_src_key and 
                pa12.incident_key = a111.incident_key and 
                pa12.priority_src_key = a111.priority_src_key and 
                pa12.problem_key = a111.problem_key and 
                pa12.row_key = a111.reported_type_src_key and 
                pa12.row_key0 = a111.location_key and 
                pa12.row_key1 = a111.symptom_src_key_c and 
                pa12.row_key3 = a111.primary_contact and 
                pa12.row_key4 = a111.infrastructure_category_src_key_c and 
                pa12.row_key5 = a111.category_src_key and 
                pa12.row_key7 = a111.data_center and 
                pa12.row_key8 = a111.business_service_key_c and 
                pa12.row_key9 = a111.assigned_to_key and 
                pa12.severity_src_key = a111.severity_src_key and 
                pa12.state_src_key = a111.state_src_key and 
                pa12.urgency_src_key = a111.urgency_src_key)
                join        ldb.d_incident_variable_work_window                a112
                  on         (pa12.incident_key = a112.row_key)
                join        ldb.d_internal_contact  a113
                  on         (pa12.row_key9 = a113.row_key)
                join        ldb.d_internal_organization_group         a114
                  on         (a111.assignment_group_key = a114.row_key and 
                pa12.assignment_group_key = a114.row_key)
                join        ldb.d_configuration_item            a115
                  on         (pa12.row_key8 = a115.row_key)
                join        ldb.d_varaible_lov_data_center               a116
                  on         (pa12.row_key7 = a116.row_key)
                join        ldb.d_internal_organization_department            a117
                  on         (a111.opened_by_department_key = a117.row_key and 
                pa12.opened_by_department_key = a117.row_key)
                join        ldb.d_internal_contact_mdm    a118
                  on         (pa12.row_current_key = a118.row_current_key)
                join        ldb.d_calendar_time      a119
                  on         (a111.opened_time_key = a119.row_key and 
                pa12.hour_24_format_num = a119.hour_24_format_num)
                join        ldb.d_incident_category              a120
                  on         (pa12.row_key5 = a120.row_key)
                join        ldb.d_incident_close_code         a121
                  on         (pa12.close_code_src_key = a121.row_key)
                join        ldb.d_incident_severity                a122
                  on         (pa12.severity_src_key = a122.row_key)
                join        ldb.d_incident_state      a123
                  on         (pa12.state_src_key = a123.row_key)
                join        ldb.d_incident_infrastructure_category_c           a124
                  on         (pa12.row_key4 = a124.row_key)
                join        ldb.d_party        a125
                  on         (pa12.row_key3 = a125.row_key)
                join        ldb.d_problem  a126
                  on         (pa12.problem_key = a126.row_key)
                join        ldb.d_incident_symptom_c        a127
                  on         (pa12.row_key1 = a127.row_key)
                join        ldb.d_task_impact          a128
                  on         (a111.impact_src_key = a128.row_key and 
                pa12.impact_src_key = a128.row_key)
                join        ldb.d_location   a129
                  on         (pa12.row_key0 = a129.row_key)
                join        ldb.d_task_priority         a130
                  on         (pa12.priority_src_key = a130.row_key)
                join        ldb.d_task_contacttype                a131
                  on         (pa12.row_key = a131.row_key)
                join        ldb.d_task_urgency        a132
                  on         (pa12.urgency_src_key = a132.row_key)
                join        ldb.d_calendar_month a133
                  on         (a18.month_start_date_key = a133.row_key)
                join        ldb.d_incident_sub_type_c        a134
                  on         (a111.sub_type_key_c = a134.row_key)
                join        ldb.d_calendar_week    a135
                  on         (a18.week_start_date_key = a135.row_key)
                join        ldb.d_calendar_quarter                a136
                  on         (a18.quarter_start_date_key = a136.row_key)
                join        ldb.d_calendar_year      a137
                  on         (a18.year_start_date_key = a137.row_key)


drop table ZZMD00


[Analytical engine calculation steps:
                1.  Calculate metric: <% Opened Incidents last to last 30 days> in the dataset
                2.  Perform dynamic aggregation over <Asset Tag Number, Assigned To, Assignment Group, Assignment Group Classification Level 1, Assignment Group Classification Level 2, BUFG L2_c, BUFG L3_c, BUFG L4_C, Business Service_c, Company, Configuration Item, Configuration Item Category, Configuration Item Class, Data Center, Date, Date Time, Day Name, Day Of Month, Day Of Week, Day Of Year, Department, Detect Timestamp, Employee, Engagement Timestamp, Hour, Incident, Incident Backlog, Incident Category (Source), Incident Cause Code, Incident Caused By Change, Incident Caused by Problem, Incident Caused By Task, Incident Causing Knowledge, Incident Close Code, Incident Major, Incident Met Sla, Incident Multiple Assignment, Incident Priority Escalated, Incident Reopened, Incident Severity (Source), Incident Short Description, Incident State (Source), Infrastructure Category_c, Month, Offering Core_C, Offering Name_C, Offering Type_C, Primary Contact, Problem, Quarter, Repair Timestamp, Resolver Group C, Scope Of Work, Solution Timestamp, Start Timestamp, Sub Type, Symptom, Task Impact (Source), Task Location, Task Priority (Source), Task Reported Type (Source), Task Urgency (Source), Week, Week Day Flag, Work Window, Year>
                3.  Calculate metric: <% Opened Incidents last to last 30 days> in the view
                4.  Perform cross-tabbing
]
