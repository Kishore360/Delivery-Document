

SELECT CASE WHEN COUNT(1) > 0 THEN 'FAILURE' ELSE 'SUCCESS' END AS Result, CASE WHEN COUNT(1) > 0 THEN 'Pass through columns from SURVEY_RESPONSE_final to FS_RESPONSE did not match' ELSE 'SUCCESS' END AS Message FROM <<tenant>>_mdsdb.survey_response_final WHERE CRC32(CONCAT( IFNULL(sys_id,''), IFNULL(sourceinstance,''), IFNULL(answer_integer,''), IFNULL(response,''), IFNULL(sys_mod_count,''), IFNULL(instance,''), IFNULL(question,''), IFNULL(sys_created_by,''), IFNULL(sys_updated_by,''), IFNULL(sys_created_on,''), IFNULL(sys_updated_on,''))) NOT IN (SELECT CRC32(CONCAT( IFNULL(row_id,''), IFNULL(source_id,''), IFNULL(response_value,''), IFNULL(response,''), IFNULL(updated_count,''), IFNULL(survey_instance_id,''), IFNULL(question_id,''), IFNULL(created_by,''), IFNULL(changed_by,''), IFNULL(created_on,''), IFNULL(changed_on,''))) FROM <<tenant>>_mdwdb.fs_response)
