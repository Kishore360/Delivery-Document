

SELECT CASE WHEN COUNT(*) >0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN COUNT(*) >0 THEN '#TABLE_NAME has invalid #COL_NAME ' ELSE 'SUCCESS' END as Message
 FROM #MDS_TABLE_SCHEMA.#BASE_TABLE 
WHERE crc32(CONCAT_WS(' ',sys_id ,sourceinstance,
 CASE WHEN #BASE_COL_NAME IS NULL THEN 'UNSPECIFIED' ELSE #BASE_COL_NAME END ))
NOT IN (SELECT crc32(CONCAT_WS(' ',row_id ,source_id ,#COL_NAME ))
FROM #TABLE_SCHEMA.#TABLE_NAME );
