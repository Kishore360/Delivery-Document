


SELECT CASE WHEN COUNT(*) > 0 THEN 'FAILURE' ELSE 'SUCCESS' END AS Result,CASE WHEN COUNT(*) > 0 
THEN 'Lookup for #TABLE_NAME.#COL_NAME did not match #REF_TABLE_NAME' ELSE 'SUCCESS' END AS Message
FROM (SELECT CONCAT(BASE.row_id,DCD.row_key) FROM #REF_TABLE_NAME DCD JOIN #TABLE_NAME BASE
ON DCD.#REF_COL_NAME = BASE.#COL_NAME
WHERE CONCAT(BASE.#REF_COL_NAME ,#REF_RETURN_NAME) NOT IN (SELECT CONCAT( row_id, #COL_NAME)
FROM #TABLE_NAME)) A
