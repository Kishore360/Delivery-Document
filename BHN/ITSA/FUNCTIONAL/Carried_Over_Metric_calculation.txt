select * from  (
select DATE_FORMAT(opened_on_key,'%Y-%b-%d'),DATE_FORMAT(opened_on_key,'%b') as abc,
DATE_FORMAT(last_resolved_on_key,'%b') as def
,opened_on_key,last_resolved_on_key,incident_number from bhn_mdwdb.f_incident where incident_number='INC0259794')a
where abc<>def


use ucsf_workdb;

select * from (
select DATE_FORMAT(opened_on_key,'%Y-%b-%d'),DATE_FORMAT(opened_on_key,'%b') as abc,
DATE_FORMAT(last_resolved_on_key,'%b') as def
,opened_on_key,last_resolved_on_key,incident_number, substring(opened_on_key,1,4) as opened_year,
substring(closed_on_key,1,4) as closed_year,

case when substring(closed_on_key,1,4)=substring(opened_on_key,1,4) and DATE_FORMAT(opened_on_key,'%b')= DATE_FORMAT(last_resolved_on_key,'%b')
then 0 else 1 end as incident_identification_flag from ucsf_mdwdb.f_incident 
)a
 where a.incident_identification_flag=1 limit 100000;