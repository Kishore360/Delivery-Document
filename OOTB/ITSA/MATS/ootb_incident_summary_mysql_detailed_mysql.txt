
  select'f_incident' as Table_Name, count(a11.row_key) Row_Count
  FROM gogo_mdwdb.f_incident a11
  WHERE a11.soft_deleted_flag = 'N'

  union 
select'd_calendar_date_opened' as Table_Name, count(a11.row_key) Row_Count
   FROM gogo_mdwdb.f_incident a11
   join (
   select d_calendar_date.row_key
    FROM gogo_mdwdb.d_calendar_date d_calendar_date
   LEFT JOIN gogo_mdwdb.d_calendar_date prev_day ON d_calendar_date.previous_day_key = prev_day.row_key
   LEFT JOIN gogo_mdwdb.d_calendar_date prev_week ON d_calendar_date.previous_week_key = prev_week.row_key AND prev_week.row_key = prev_week.week_start_date_key
   LEFT JOIN gogo_mdwdb.d_calendar_date prev_month ON d_calendar_date.previous_month_key = prev_month.row_key AND prev_month.row_key = prev_month.period_start_date_key
   LEFT JOIN gogo_mdwdb.d_calendar_date prev_quarter ON d_calendar_date.previous_quarter_key = prev_quarter.row_key AND prev_quarter.row_key = prev_quarter.quarter_start_date_key
   LEFT JOIN gogo_mdwdb.d_calendar_date prev_year ON d_calendar_date.previous_year_key = prev_year.row_key AND prev_year.row_key = prev_year.year_start_date_key
   
   )  a12
on (a11.opened_on_key = a12.row_key)
  WHERE a11.soft_deleted_flag = 'N'  
  union
 select'd_calendar_time' as Table_Name, count(a11.row_key) Row_Count
FROM gogo_mdwdb.f_incident a11
   join (
   select d_calendar_time.row_key
    FROM gogo_mdwdb.d_calendar_time
   )  a12
on (a11.opened_time_key = a12.row_key)
 WHERE a11.soft_deleted_flag = 'N'  
union
select'd_configuration_item' as Table_Name, count(a11.row_key) Row_Count
FROM gogo_mdwdb.f_incident a11
join   gogo_mdwdb.d_configuration_item      a13
on (a11.configuration_item_key = a13.row_key)
 WHERE a11.soft_deleted_flag = 'N' 

union


select'd_calendar_year' as Table_Name, count(a11.row_key) Row_Count
 from  gogo_mdwdb.f_incident             a11
 join (
   select d_calendar_date.row_key,d_calendar_date.year_start_date_key
    FROM gogo_mdwdb.d_calendar_date d_calendar_date
   LEFT JOIN gogo_mdwdb.d_calendar_date prev_day ON d_calendar_date.previous_day_key = prev_day.row_key
   LEFT JOIN gogo_mdwdb.d_calendar_date prev_week ON d_calendar_date.previous_week_key = prev_week.row_key AND prev_week.row_key = prev_week.week_start_date_key
   LEFT JOIN gogo_mdwdb.d_calendar_date prev_month ON d_calendar_date.previous_month_key = prev_month.row_key AND prev_month.row_key = prev_month.period_start_date_key
   LEFT JOIN gogo_mdwdb.d_calendar_date prev_quarter ON d_calendar_date.previous_quarter_key = prev_quarter.row_key AND prev_quarter.row_key = prev_quarter.quarter_start_date_key
   LEFT JOIN gogo_mdwdb.d_calendar_date prev_year ON d_calendar_date.previous_year_key = prev_year.row_key AND prev_year.row_key = prev_year.year_start_date_key
   
   )  a12
on (a11.opened_on_key = a12.row_key)
join (
select d_calendar_date.row_key
FROM gogo_mdwdb.d_calendar_date d_calendar_date
   LEFT JOIN gogo_mdwdb.d_calendar_date prev_year ON d_calendar_date.previous_year_key = prev_year.row_key AND prev_year.row_key = prev_year.year_start_date_key
  WHERE d_calendar_date.year_start_date_key = d_calendar_date.row_key AND d_calendar_date.source_id = 0
)a14
on (a12.year_start_date_key = a14.row_key)
WHERE a11.soft_deleted_flag = 'N' 

union
select'd_incident' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11 
join gogo_mdwdb.d_incident       a15
on (a11.incident_key = a15.row_key)
WHERE a11.soft_deleted_flag = 'N' 
union
select'd_incident_category' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11 
join (

select lov.row_key
FROM gogo_mdwdb.d_lov lov
WHERE lov.dimension_class = 'CATEGORY~INCIDENT' OR lov.row_key = -1 OR lov.row_key = 0

)    a16
on (a11.category_src_key = a16.row_key) 
WHERE a11.soft_deleted_flag = 'N' 

union 

select'd_incident_severity' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11 
join (
SELECT lov.row_key
   FROM gogo_mdwdb.d_lov lov
   LEFT JOIN gogo_mdwdb.d_lov_map br ON lov.row_key = br.src_key
   JOIN gogo_mdwdb.d_lov wh_lov ON wh_lov.row_key = br.wh_key AND br.dimension_class = 'SEVERITY~INCIDENT'
UNION ALL 
 SELECT lov.row_key
   FROM gogo_mdwdb.d_lov lov
  WHERE lov.row_key = -1 OR lov.row_key = 0

)a17
on (a11.severity_src_key = a17.row_key)
WHERE a11.soft_deleted_flag = 'N'
union
select'd_incident_state' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11 
join (
SELECT lov.row_key
   FROM gogo_mdwdb.d_lov lov
   LEFT JOIN gogo_mdwdb.d_lov_map br ON lov.row_key = br.src_key
   JOIN gogo_mdwdb.d_lov wh_lov ON wh_lov.row_key = br.wh_key AND br.dimension_class  = 'STATE~INCIDENT'
UNION ALL 
 SELECT lov.row_key
   FROM gogo_mdwdb.d_lov lov
  WHERE lov.row_key = -1 OR lov.row_key = 0


)      a18
on (a11.state_src_key = a18.row_key)
WHERE a11.soft_deleted_flag = 'N'
union
select'd_incident_subcategory' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11 
join (
 SELECT lov.row_key
   FROM gogo_mdwdb.d_lov lov
   LEFT JOIN gogo_mdwdb.d_lov parent ON parent.source_id = lov.source_id AND parent.dimension_class  = 'CATEGORY~INCIDENT'  AND parent.src_rowid  = (('CATEGORY~INCIDENT'  || '~~~' ) || upper(lov.dimension_type ))
  WHERE lov.dimension_class = 'SUBCATEGORY~INCIDENT'
UNION ALL 
 SELECT  lov.row_key
   FROM gogo_mdwdb.d_lov lov
  WHERE lov.row_key = -1 OR lov.row_key = 0

)      a19
on (a11.sub_category_src_key = a19.row_key)
WHERE a11.soft_deleted_flag = 'N'
union

select'd_internal_contact' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11 
join gogo_mdwdb.d_internal_contact       a110
on (a11.opened_by_key = a110.row_key)
WHERE a11.soft_deleted_flag = 'N'
union
select'd_internal_contact_mdm' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11
join gogo_mdwdb.d_internal_contact       a110
on (a11.opened_by_key = a110.row_key)
join (
 SELECT d_internal_contact.row_current_key
   FROM gogo_mdwdb.d_internal_contact
  WHERE d_internal_contact.current_flag = 'Y'
) a111
on (a110.row_current_key = a111.row_current_key)
WHERE a11.soft_deleted_flag = 'N'
union
select'd_internal_organization_department' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11 
join (
 SELECT d_internal_organization.row_key
   FROM gogo_mdwdb.d_internal_organization
  WHERE d_internal_organization.department_flag = 'Y' OR d_internal_organization.row_key = 0 OR d_internal_organization.row_key = -1

)     a112
on (a11.opened_by_department_key = a112.row_key)
WHERE a11.soft_deleted_flag = 'N'
union
select'd_internal_organization_group' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11 
join (
 SELECT  d_internal_organization.row_key
   FROM gogo_mdwdb.d_internal_organization
  WHERE d_internal_organization.group_flag = 'Y' OR d_internal_organization.row_key = 0 OR d_internal_organization.row_key = -1
)      a113
on (a11.assignment_group_key = a113.row_key)
WHERE a11.soft_deleted_flag = 'N'
union
select'd_location' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11 
join (
 SELECT a.row_key
   FROM gogo_mdwdb.d_location a
   LEFT JOIN gogo_mdwdb.d_geography b ON a.geo_key = b.row_key AND a.source_id = b.source_id
)    a114
on (a11.location_key = a114.row_key)
WHERE a11.soft_deleted_flag = 'N'
union
select'd_task_contacttype' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11 
join (
 SELECT lov.row_key
   FROM gogo_mdwdb.d_lov lov
  WHERE lov.dimension_class = 'CONTACT_TYPE~TASK'
UNION 
 SELECT lov.row_key
   FROM gogo_mdwdb.d_lov lov
  WHERE lov.row_key = -1 OR lov.row_key = 0 

) a115
on (a11.reported_type_src_key = a115.row_key)
WHERE a11.soft_deleted_flag = 'N'
union
select'd_task_impact' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11 
join  (
 SELECT lov.row_key
   FROM gogo_mdwdb.d_lov lov
   LEFT JOIN gogo_mdwdb.d_lov_map br ON lov.row_key = br.src_key
   JOIN gogo_mdwdb.d_lov wh_lov ON wh_lov.row_key = br.wh_key AND br.dimension_class = 'IMPACT~TASK'
UNION 
 SELECT lov.row_key
   FROM gogo_mdwdb.d_lov lov
  WHERE lov.row_key = -1 OR lov.row_key = 0
) a116
on (a11.impact_src_key = a116.row_key)
WHERE a11.soft_deleted_flag = 'N'
union
select'd_task_priority' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11 
join (
 SELECT lov.row_key
   FROM gogo_mdwdb.d_lov lov
   LEFT JOIN gogo_mdwdb.d_lov_map br ON lov.row_key = br.src_key
   JOIN gogo_mdwdb.d_lov wh_lov ON wh_lov.row_key = br.wh_key AND br.dimension_class  = 'PRIORITY~TASK' 
UNION 
 SELECT lov.row_key
   FROM gogo_mdwdb.d_lov lov
  WHERE lov.row_key = -1 OR lov.row_key = 0
) a117
on (a11.priority_src_key = a117.row_key)
WHERE a11.soft_deleted_flag = 'N'
union
select'd_task_urgency' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11 
join  (
 SELECT lov.row_key
   FROM gogo_mdwdb.d_lov lov
   LEFT JOIN gogo_mdwdb.d_lov_map br ON lov.row_key = br.src_key
   JOIN gogo_mdwdb.d_lov wh_lov ON wh_lov.row_key = br.wh_key AND br.dimension_class  = 'URGENCY~TASK' 
UNION 
 SELECT lov.row_key
   FROM gogo_mdwdb.d_lov lov
  WHERE lov.row_key = -1 OR lov.row_key = 0
)       a118
on (a11.urgency_src_key = a118.row_key)
WHERE a11.soft_deleted_flag = 'N'
union
select'd_internal_contact' as Table_Name, count(a11.row_key) Row_Count
from  gogo_mdwdb.f_incident             a11 
join gogo_mdwdb.d_internal_contact       a119
on (a11.assigned_to_key = a119.row_key)
WHERE a11.soft_deleted_flag = 'N'


