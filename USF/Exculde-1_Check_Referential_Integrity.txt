
SELECT CASE WHEN COUNT(1) > 0 THEN 'FAILURE' ELSE 'SUCCESS' END AS Result,CASE WHEN COUNT(1) > 0 THEN '#CHILD_TABLE has #CHILD_DEPENDENCY_KEY not found in #PARENT_TABLE' ELSE '#CHILD_TABLE has all #CHILD_DEPENDENCY_KEY from #PARENT_TABLE' END AS Message
FROM (SELECT 1 FROM #CHILD_TABLE WHERE #CHILD_DEPENDENCY_KEY NOT IN (SELECT DISTINCT #PARENT_DEPENDENCY_KEY FROM #PARENT_TABLE )AND #CHILD_DEPENDENCY_KEY NOT IN (0,-1) LIMIT 1) A
