d_change_request_u_moratorium_bypass_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.change_request_final SRC
LEFT JOIN ntrust_mdwdb.d_change_request TRGT2 ON (SRC.sys_id=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
-- Left JOIN ntrust_mdwdb.d_lov LKP ON CONCAT('CLOSE_CODE~CHANGE_REQUEST','~',UPPER(SRC.close_code))=LKP.row_id  AND SRC.sourceinstance=LKP.source_id
where case when u_moratorium_bypass=1 then 'Y' else 'N' end <> TRGT2.u_moratorium_bypass_c and SRC.cdctype='X') temp;

*********d_change_request_incident_caused_by_change_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.change_request_final SRC
LEFT JOIN ntrust_mdwdb.d_change_request TRGT2 ON (SRC.sys_id=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
-- Left JOIN ntrust_mdwdb.d_lov LKP ON CONCAT('CLOSE_CODE~CHANGE_REQUEST','~',UPPER(SRC.close_code))=LKP.row_id  AND SRC.sourceinstance=LKP.source_id
where case when u_moratorium_bypass=1 then 'Y' else 'N' end <> TRGT2.u_moratorium_bypass_c and SRC.cdctype='X') temp;


*********d_change_request_incidents_caused_by_change_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.change_request_final SRC
LEFT JOIN ntrust_mdwdb.d_change_request TRGT2 ON (SRC.sys_id=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
-- Left JOIN ntrust_mdwdb.d_lov LKP ON CONCAT('CLOSE_CODE~CHANGE_REQUEST','~',UPPER(SRC.close_code))=LKP.row_id  AND SRC.sourceinstance=LKP.source_id
where case when u_moratorium_bypass=1 then 'Y' else 'N' end <> TRGT2.u_moratorium_bypass_c and SRC.cdctype='X') temp;



d_change_request_justification_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.change_request_final SRC
LEFT JOIN ntrust_mdwdb.d_change_request TRGT2 ON (SRC.sys_id=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
-- Left JOIN ntrust_mdwdb.d_lov LKP ON CONCAT('CLOSE_CODE~CHANGE_REQUEST','~',UPPER(SRC.close_code))=LKP.row_id  AND SRC.sourceinstance=LKP.source_id
where coalesce(SRC.justification,'UNSPECIFIED')<> TRGT2.justification_c and SRC.cdctype='X') temp;


d_change_request_planned_start_date_c_mysql
SELECT 
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_problem_task.due_on' ELSE 'SUCCESS' END as Message
FROM 
(
Select count(1) as CNT
FROM  ntrust_mdsdb.change_request_final SRC
LEFT JOIN ntrust_mdwdb.d_change_request TRGT2 ON (SRC.sys_id=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where
TRGT2.planned_start_date_c<>(CONVERT_TZ(SRC.expected_start,'GMT','US/Central'))
and SRC.cdctype='X') temp;


************d_change_request_prb_rfc_chng_num_c_mysql




****************d_change_request_u_process_exception_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.change_request_final SRC
LEFT JOIN ntrust_mdwdb.d_change_request TRGT2 ON (SRC.sys_id=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
Left JOIN ntrust_mdwdb.d_lov LKP ON CONCAT('PROCESS_EXCEPTION_SRC_C~CHANGE_REQUEST~',UPPER(SRC.u_process_exception))=LKP.row_id  AND SRC.sourceinstance=LKP.source_id
where coalesce(SRC.u_process_exception,'UNSPECIFIED')<> TRGT2.u_process_exception_c and SRC.cdctype='X') temp;


*******************d_configuration_item_configuration_item_number_c_mysql

d_infosys_exclusion_file_c_assignment_group_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.us_infosys_exclusions_file_final SRC
LEFT JOIN ntrust_mdwdb.d_infosys_exclusion_file_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.assignment_group,'UNSPECIFIED')<> TRGT2.assignment_group_c and SRC.cdctype='X') temp;

d_infosys_exclusion_file_c_cluster_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.us_infosys_exclusions_file_final SRC
LEFT JOIN ntrust_mdwdb.d_infosys_exclusion_file_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.cluster,'UNSPECIFIED')<> TRGT2.cluster_c and SRC.cdctype='X') temp;


d_infosys_exclusion_file_c_exclusion_type_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.us_infosys_exclusions_file_final SRC
LEFT JOIN ntrust_mdwdb.d_infosys_exclusion_file_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.exclusion_type,'UNSPECIFIED')<> TRGT2.exclusion_type_c and SRC.cdctype='X') temp;


d_infosys_exclusion_file_c_fixed_effort_category_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.us_infosys_exclusions_file_final SRC
LEFT JOIN ntrust_mdwdb.d_infosys_exclusion_file_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.fixed_effort_category,'UNSPECIFIED')<> TRGT2.fixed_effort_category_c and SRC.cdctype='X') temp;

d_infosys_exclusion_file_c_lob_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.us_infosys_exclusions_file_final SRC
LEFT JOIN ntrust_mdwdb.d_infosys_exclusion_file_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.lob,'UNSPECIFIED')<> TRGT2.lob_c and SRC.cdctype='X') temp;


d_infosys_exclusion_file_c_month_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.us_infosys_exclusions_file_final SRC
LEFT JOIN ntrust_mdwdb.d_infosys_exclusion_file_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.month,'UNSPECIFIED')<> TRGT2.month_c and SRC.cdctype='X') temp;

d_infosys_exclusion_file_c_number_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.us_infosys_exclusions_file_final SRC
LEFT JOIN ntrust_mdwdb.d_infosys_exclusion_file_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.number,'UNSPECIFIED')<> TRGT2.number_c and SRC.cdctype='X') temp;

d_infosys_exclusion_file_c_priority_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.us_infosys_exclusions_file_final SRC
LEFT JOIN ntrust_mdwdb.d_infosys_exclusion_file_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.priority,'UNSPECIFIED')<> TRGT2.priority_c and SRC.cdctype='X') temp;

d_infosys_exclusion_file_c_resolved_at_closed_at_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.us_infosys_exclusions_file_final SRC
LEFT JOIN ntrust_mdwdb.d_infosys_exclusion_file_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.resolved_at_closed_at,'UNSPECIFIED')<> TRGT2.resolved_at_closed_at_c and SRC.cdctype='X') temp;


d_infosys_exclusion_file_c_short_description_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.us_infosys_exclusions_file_final SRC
LEFT JOIN ntrust_mdwdb.d_infosys_exclusion_file_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.short_description,'UNSPECIFIED')<> TRGT2.short_description_c and SRC.cdctype='X') temp;

d_infosys_exclusion_file_c_type_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.us_infosys_exclusions_file_final SRC
LEFT JOIN ntrust_mdwdb.d_infosys_exclusion_file_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.type,'UNSPECIFIED')<> TRGT2.type_c and SRC.cdctype='X') temp;



***************d_internal_contact_opened_by_service_desk_flag_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_internal.opened_by_service_desk_flag_c' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.incident_final SRC
left join ntrust_mdsdb.sys_user_final SRC1
on SRC.opened_by=SRC1.sys_id
LEFT JOIN ntrust_mdwdb.d_internal_contact TRGT2 ON (concat('INTERNAL_CONTACT~',SRC1.sys_id)=TRGT2.row_id AND SRC1.sourceinstance=TRGT2.source_id)
 left join ntrust_mdwdb.d_internal_organization LKP1
 on concat('GROUP~',SRC1.u_default_support_group)=LKP1.row_id and SRC1.sourceinstance=LKP1.source_id
where case
            when LKP1.organization_name in  ('Help Desk: Institutional Investor Passport',
            'IT Service Request Planning',
            'NATS Service Desk',
            'Service Desk') then 'Y'
            else 'N'
        end <> TRGT2.opened_by_service_desk_flag_c and SRC.cdctype='X' )temp;



d_operational_bu_c_description_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.u_operational_business_unit_final SRC
LEFT JOIN ntrust_mdwdb.d_operational_bu_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.u_description,'UNSPECIFIED')<> TRGT2.description_c and SRC.cdctype='X') temp;


d_operational_bu_c_keyword_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.u_operational_business_unit_final SRC
LEFT JOIN ntrust_mdwdb.d_operational_bu_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.u_keyword,'UNSPECIFIED')<> TRGT2.keyword_c and SRC.cdctype='X') temp;


d_operational_bu_c_level_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.u_operational_business_unit_final SRC
LEFT JOIN ntrust_mdwdb.d_operational_bu_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.u_level,'UNSPECIFIED')<> TRGT2.level_c and SRC.cdctype='X') temp;


d_operational_bu_c_name_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.u_operational_business_unit_final SRC
LEFT JOIN ntrust_mdwdb.d_operational_bu_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.u_name,'UNSPECIFIED')<> TRGT2.name_c and SRC.cdctype='X') temp;


d_operational_bu_c_op_bui_head_id_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.u_operational_business_unit_final SRC
LEFT JOIN ntrust_mdwdb.d_operational_bu_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.u_description,'UNSPECIFIED')<> TRGT2.description_c and SRC.cdctype='X') temp;


d_operational_bu_c_op_bui_head_name_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.u_operational_business_unit_final SRC
LEFT JOIN ntrust_mdwdb.d_operational_bu_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.description,'UNSPECIFIED')<> TRGT2.description_c and SRC.cdctype='X') temp;


d_operational_bu_c_parent_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.u_operational_business_unit_final SRC
LEFT JOIN ntrust_mdwdb.d_operational_bu_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.u_parent,'UNSPECIFIED')<> TRGT2.parent_c and SRC.cdctype='X') temp;


d_operational_bu_c_work_notes_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.u_operational_business_unit_final SRC
LEFT JOIN ntrust_mdwdb.d_operational_bu_c TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
where coalesce(SRC.u_work_notes,'UNSPECIFIED')<> TRGT2.work_notes_c and SRC.cdctype='X') temp;



d_problem_cbi_inc_causd_by_chng_flag_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.problem_final SRC
LEFT JOIN ntrust_mdwdb.d_problem TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
left join ntrust_mdwdb.d_incident inc on TRGT2.row_id=inc.problem_id
where case when inc.caused_by_change_flag='Y' then 'Y' else 'N' end <> TRGT2.inc_causd_by_chng_flag_c and SRC.cdctype='X') temp;


d_problem_cbi_inc_caused_by_chge_nmbr_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.problem_final SRC
LEFT JOIN ntrust_mdwdb.d_problem TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
left join ntrust_mdwdb.d_incident inc on TRGT2.row_id=inc.problem_id
where case when inc.caused_by_change_flag='Y' then inc.caused_by_change_number_c else 'UNSPCIFIED' end <> TRGT2.cbi_inc_caused_by_chge_nmbr_c and SRC.cdctype='X') temp;

d_problem_how_was_service_restored_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.problem_final SRC
LEFT JOIN ntrust_mdwdb.d_problem TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
left join ntrust_mdwdb.d_incident inc on TRGT2.row_id=inc.u_cbi_incident
where case when inc.u_cbi_incident is not null then inc.number else 'UNSPCIFIED' end <> TRGT2.how_was_service_restored_c and SRC.cdctype='X') temp;



d_problem_other_contributing_factors_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.problem_final SRC
LEFT JOIN ntrust_mdwdb.d_problem TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
left join ntrust_mdwdb.d_incident inc on TRGT2.row_id=inc.u_cbi_incident
where case when inc.u_cbi_incident is not null then inc.number else 'UNSPCIFIED' end <> TRGT2.other_contributing_factors_c and SRC.cdctype='X') temp;



d_problem_prblm_linked_cbi_inc_nmbr_c_mysql
SELECT
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_change_request.close_code_src_key' ELSE 'SUCCESS' END as Message
from(Select count(1) as CNT
FROM  ntrust_mdsdb.problem_final SRC
LEFT JOIN ntrust_mdwdb.d_problem TRGT2 ON (SRC.number=TRGT2.row_id AND SRC.sourceinstance=TRGT2.source_id)
left join ntrust_mdwdb.d_incident inc on TRGT2.row_id=inc.u_cbi_incident
where case when inc.u_cbi_incident is not null then inc.number else 'UNSPCIFIED' end <> TRGT2.prblm_linked_cbi_inc_nmbr_c and SRC.cdctype='X') temp;



f_task_sla_end_time_c_mysql

SELECT 
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_problem_task.due_on' ELSE 'SUCCESS' END as Message
FROM 
(
select count(1) as CNT
from
ntrs_mdsdb.task_sla_final SRC
join
ntrs_mdwdb.f_task_sla TRGT
on (SRC.sys_id=TRGT.row_id and SRC.sourceinstance=TRGT.source_id)
where
TRGT.end_time_c<>(CONVERT_TZ(SRC.end_time,'GMT','US/Central'))
and SRC.cdctype='X') temp;


f_task_sla_planned_end_time_c_mysql


SELECT 
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_problem_task.due_on' ELSE 'SUCCESS' END as Message
FROM 
(
select count(1) as CNT
from
ntrs_mdsdb.task_sla_final SRC
join
ntrs_mdwdb.f_task_sla TRGT
on (SRC.sys_id=TRGT.row_id and SRC.sourceinstance=TRGT.source_id)
where
TRGT.planned_end_time_c<>(CONVERT_TZ(SRC.planned_end_time,'GMT','US/Central'))
and SRC.cdctype='X') temp;


		
				
f_task_sla_start_time_c_mysql
task_sla.start_time AS start_time_c,
SELECT 
CASE WHEN CNT > 0 THEN 'FAILURE' ELSE 'SUCCESS' END as Result,
CASE WHEN CNT > 0 THEN 'MDS to DWH data validation failed for d_problem_task.due_on' ELSE 'SUCCESS' END as Message
FROM 
(
select count(1) as CNT
from
ntrs_mdsdb.task_sla_final SRC
join
ntrs_mdwdb.f_task_sla TRGT
on (SRC.sys_id=TRGT.row_id and SRC.sourceinstance=TRGT.source_id)
where
TRGT.start_time_c<>(CONVERT_TZ(SRC.start_time,'GMT','US/Central'))
and SRC.cdctype='X') temp;





f_task_sla_task_sla_met_all_sla_flag_c_mysql

